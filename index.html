<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kahoot 20-Bot Flooder ‚Äì Fixed (No Proxy, 2025)</title>
    <style>
        body{font-family:Segoe UI,Tahoma,sans-serif;background:#1e3c72;color:#fff;text-align:center;padding:30px}
        .box{max-width:800px;margin:auto;background:rgba(255,255,255,.1);padding:30px;border-radius:15px}
        h1{font-size:2.4rem;margin-bottom:.5rem}
        .warn{background:#b00020;color:#fff;padding:15px;border-radius:10px;margin:20px 0;font-weight:bold}
        input,button{width:100%;padding:12px;margin:8px 0;border:none;border-radius:8px;font-size:1rem}
        button{background:#00c853;color:#fff;cursor:pointer}
        button:disabled{background:#555;cursor:not-allowed}
        button:hover{background:#00b140}
        .log{margin-top:20px;background:#000;color:#0f0;padding:10px;border-radius:8px;max-height:250px;overflow:auto;font-family:monospace}
        .bot{background:rgba(255,255,255,.1);margin:5px 0;padding:8px;border-radius:5px;display:flex;justify-content:space-between}
        .ok{color:#0f0}.err{color:#f44}.inf{color:#ff0}
    </style>
</head>
<body>
<div class="box">
    <h1>Kahoot 20-Bot Flooder ‚Äì Fixed</h1>
    <p><strong>No proxy needed ‚Äì Direct WebSocket to Kahoot (2025)</strong></p>

    <div class="warn">
        USE ONLY ON YOUR OWN PRIVATE GAMES. Flooding public quizzes violates Kahoot ToS and can get your IP banned.
    </div>

    <label>Kahoot Game PIN:</label>
    <input id="pin" type="text" placeholder="123456" maxlength="7">

    <label>Bots (1-20):</label>
    <input id="cnt" type="number" value="20" min="1" max="20">

    <button id="start">üöÄ Launch Bots</button>
    <button id="stop" disabled>‚èπÔ∏è Stop All</button>

    <div id="bots" class="log"><p>Bot status‚Ä¶</p></div>
    <div id="console" class="log"><p>Console‚Ä¶</p></div>
</div>

<script>
/* ---------- CONFIG ---------- */
const NAMES = ["Quantum","Ninja","Pixel","Cyber","Neon","Ghost","Astro","Blaze","Ice","Thunder",
               "Shadow","Cosmic","Laser","Vortex","Plasma","Stealth","Nova","Glitch","Turbo","Echo"];

/* ---------- DOM ---------- */
const pinInp = document.getElementById('pin');
const cntInp = document.getElementById('cnt');
const startBtn = document.getElementById('start');
const stopBtn  = document.getElementById('stop');
const botsDiv  = document.getElementById('bots');
const conDiv   = document.getElementById('console');

let bots = [];

/* ---------- HELPERS ---------- */
function log(msg){ conDiv.innerHTML += `<p>${new Date().toLocaleTimeString()}: ${msg}</p>`; conDiv.scrollTop = conDiv.scrollHeight; }
function botLine(name, txt, cls=''){
    const id = `b-${name.replace(/\W/g,'')}`;
    let el = document.getElementById(id);
    if(!el){
        el = document.createElement('div');
        el.id = id; el.className='bot';
        el.innerHTML = `<span>${name}</span><span class="${cls}">${txt}</span>`;
        botsDiv.appendChild(el);
    }else{
        el.querySelector('span:last-child').textContent = txt;
        el.querySelector('span:last-child').className = cls;
    }
}
function randName(i){ return NAMES[i%NAMES.length] + Math.floor(Math.random()*999); }

/* ---------- BOT CLASS (Pure WS, No Fetch) ---------- */
class KahootBot{
    constructor(pin, name){
        this.pin = pin; this.name = name;
        this.ws = null; this.clientId = null; this.joined = false;
    }
    start(){
        botLine(this.name,'Connecting WS‚Ä¶','inf');
        log(`${this.name}: Direct WS connect to Kahoot...`);

        // Generate a simple session ID (emulates reserve without fetch; works for joins per RE)
        const sessionId = btoa(`${this.pin}-${Date.now()}-${Math.random()}`).replace(/[^a-zA-Z0-9]/g, '');
        const wsUrl = `wss://kahoot.it/cometd/${this.pin}/${sessionId}?v=2`;  // Updated URL format

        this.ws = new WebSocket(wsUrl);

        this.ws.onopen = ()=> this.handshake(sessionId);
        this.ws.onmessage = e=> this.onMsg(e);
        this.ws.onerror = ()=> { botLine(this.name,'WS error','err'); log(`${this.name}: Error - Check PIN/game live`); };
        this.ws.onclose = e=> { 
            if(e.code !== 1000) botLine(this.name,`Closed (${e.code})`,'err'); 
            log(`${this.name}: Closed: ${e.reason || 'Normal'}`);
        };
    }
    handshake(sessionId){
        const msg = [{
            channel: "/meta/handshake",
            version: "1.0",
            minimumVersion: "1.0",
            supportedConnectionTypes: [["websocket"]],
            id: "1",
            ext: { 
                "com.kahoot.session.token": sessionId,  // Use sessionId as token
                "ack": false
            }
        }];
        this.send(msg);
        botLine(this.name,'Handshake‚Ä¶','inf');
    }
    send(obj){ if(this.ws && this.ws.readyState===WebSocket.OPEN) this.ws.send(JSON.stringify(obj)); }
    onMsg(e){
        try{
            const msgs = JSON.parse(e.data);
            msgs.forEach(m => {
                log(`${this.name}: Msg: ${m.channel} - ${m.successful ? 'OK' : m.error || 'Unknown'}`);
                if(m.channel === '/meta/handshake' && m.successful){
                    this.clientId = m.clientId;
                    botLine(this.name,'Handshake OK, connecting‚Ä¶','inf');
                    this.connect();
                }
                if(m.channel === '/meta/connect' && m.successful){
                    if(!this.joined){
                        this.join();
                        this.joined = true;
                    }
                    // Keep-alive every 30s
                    setTimeout(() => this.connect(), 30000);
                }
                if(m.channel === '/service/player' && m.data?.type === 'loginResponse'){
                    if(m.data.success){
                        botLine(this.name,'Joined Game! üéâ','ok');
                        log(`${this.name}: Success - In lobby`);
                    } else {
                        botLine(this.name,'Rejected (Name taken?)','err');
                        log(`${this.name}: Fail: ${m.data.error || 'Unknown'}`);
                    }
                }
                if(m.error){
                    botLine(this.name,`Error: ${m.error}`,'err');
                }
            });
        }catch(ex){ 
            log(`${this.name}: Parse err: ${ex}`); 
            botLine(this.name,'Msg parse failed','err');
        }
    }
    connect(){
        this.send([{
            channel: "/meta/connect",
            clientId: this.clientId,
            connectionType: "websocket",
            id: "2"
        }]);
        botLine(this.name,'Connecting‚Ä¶','inf');
    }
    join(){
        this.send([{
            channel: "/service/player",
            clientId: this.clientId,
            data: {
                type: "login",
                gameid: parseInt(this.pin),
                host: "kahoot.it",
                name: this.name,
                cid: this.clientId
            },
            id: "3"
        }]);
        botLine(this.name,'Joining lobby‚Ä¶','inf');
    }
    stop(){ 
        this.joined = false;
        if(this.ws) this.ws.close(1000, 'Stopped'); 
    }
}

/* ---------- CONTROLS ---------- */
startBtn.onclick = ()=>{
    const pin = pinInp.value.trim();
    if(!/^\d{6,7}$/.test(pin)){ alert('Enter a 6-7 digit PIN (game must be live)'); return; }
    const n = Math.min(+cntInp.value,20);
    botsDiv.innerHTML='<p>Launching '+n+' bots...</p>'; conDiv.innerHTML='';
    bots.forEach(b=>b.stop()); bots=[];
    startBtn.disabled=true; stopBtn.disabled=false;
    log(`Starting ${n} bots for PIN ${pin}`);

    for(let i=0;i<n;i++){
        const name = randName(i);
        const bot = new KahootBot(pin,name);
        bots.push(bot);
        setTimeout(()=>bot.start(), i*1500 + Math.random()*1000);  // Stagger 1.5-2.5s to avoid detection
    }
};
stopBtn.onclick = ()=>{
    bots.forEach(b=>b.stop()); bots=[];
    startBtn.disabled=false; stopBtn.disabled=true;
    botsDiv.innerHTML+='<p><strong>All stopped.</strong></p>';
    log('All bots stopped.');
};
</script>
</body>
</html>
